version: '3.8'
services:
  django-prod:
    image: python:3.11
    container_name: django-prod
    network_mode: "host"
    restart: always
    working_dir: /app
    volumes:
      - /volume3/web/django-service:/app
    # [수정됨] apt-get으로 시스템 의존성 설치 및 migrate 명령어 추가
    command: >
      bash -c "apt-get update && apt-get install -y default-libmysqlclient-dev pkg-config &&
               pip install -r requirements.txt &&
               pip install gunicorn &&
               python manage.py migrate &&
               gunicorn config.wsgi:application --bind 0.0.0.0:8005"